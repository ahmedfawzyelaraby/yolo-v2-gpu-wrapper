CMAKE_MINIMUM_REQUIRED(VERSION 2.8)

SET(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -std=c++11 -v -pthread -ffast-math -funroll-loops -O3 -mavx -omp")
SET(CUDA_PROPAGATE_HOST_FLAGS OFF)
SET(CUDA_SEPARABLE_COMPILATION OFF)
LIST(APPEND CUDA_NVCC_FLAGS "-arch=sm_35;-std=c++11")

FIND_PACKAGE(CUDA REQUIRED)
FIND_PACKAGE(OpenCV REQUIRED)

ADD_DEFINITIONS(-DGPU)

CUDA_INCLUDE_DIRECTORIES(${CUDA_INCLUDE_DIRS})
INCLUDE_DIRECTORIES(${CUDA_INCLUDE_DIRS})
INCLUDE_DIRECTORIES(code)
# LINK_DIRECTORIES(/usr/local/cuda/lib64)

FILE(GLOB SOURCES "code/*.cu" "code/*.cpp" "code/*.c" "code/*.h")
FILE(GLOB CUDA_SOS "/usr/local/cuda/lib64/*.so")
CUDA_ADD_LIBRARY(lbmslv SHARED ${SOURCES})
TARGET_LINK_LIBRARIES(lbmslv ${OpenCV_LIBS} ${CUDA_SOS})

ADD_EXECUTABLE(runrun Main.cpp)
TARGET_LINK_LIBRARIES(runrun ${OpenCV_LIBS} /home/ahmedfawzyelaraby/Thesis_WS/Code/YOLO_Standalone_Wrapper/liblbmslv.so)